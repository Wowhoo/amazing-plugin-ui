/*! jQuery tooltip - v0.1.0 - 2013-10-12
* https://github.com/amazingSurge/jquery-tooltip
* Copyright (c) 2013 amazingSurge; Licensed GPL */
(function(t){"use strict";function e(t,e,n,i,s,o){var a,r,l,c=0,h=0;switch(o?(a=t,r=0,l=0):(a=t.offset(),r=t.outerWidth(),l=t.outerHeight()),e){case"n":c=a.left+r/2-n/2,h=a.top-i-s;break;case"e":c=a.left+r+s,h=a.top+l/2-i/2;break;case"s":c=a.left+r/2-n/2,h=a.top+l+s;break;case"w":c=a.left-n-s,h=a.top+l/2-i/2;break;case"nw":case"wn":c=a.left-n+20,h=a.top-i-s;break;case"ne":case"en":c=a.left+r-20,h=a.top-i-s;break;case"sw":case"ws":c=a.left-n+20,h=a.top+l+s;break;case"se":case"es":c=a.left+r-20,h=a.top+l+s}return{left:Math.round(c),top:Math.round(h)}}function n(t,e){var n,i,s=o.scrollLeft(),a=o.scrollTop(),r=t.offset(),l=t.outerWidth(!0),c=t.outerHeight(!0),h=o.width(),p=o.height(),u=[];return e?(n=e.outerWidth(!0),i=e.outerHeight(!0)):(n=100,i=50),a+i>r.top&&u.push("n"),r.top+c+i>a+p&&u.push("s"),s+n>r.left&&u.push("w"),r.left+l+n>s+h&&u.push("e"),u}function i(){var t=document.body||document.documentElement,e=t.style,n="transition";if("string"==typeof e[n])return!0;s=["Moz","Webkit","Khtml","O","ms"],n=n.charAt(0).toUpperCase()+n.substr(1);for(var i=0;s.length>i;i++)if("string"==typeof e[s[i]+n])return!0;return!1}var s,o=t(window),a=!1,r=[],l="nswe",c={n:{n:"s",w:"ne",e:"nw"},s:{s:"n",w:"se",e:"sw"},w:{w:"e",n:"sw",s:"nw"},e:{e:"w",n:"se",s:"ne"},nw:{n:"sw",w:"ne"},ne:{n:"se",e:"nw"},sw:{s:"nw",w:"se"},se:{s:"ne",e:"sw"}},h=!0;i()||(h=!1);var p=t.tooltip=function(e,n){var i={};this.$elem=t(e),t.each(this.$elem.data(),function(t,e){/^tooltip/i.test(t)&&(i[t.toLowerCase().replace(/^tooltip/i,"")]=e)}),this.options=t.extend({},p.defaults,n,i),this.namespace=this.options.namespace,this.$elem.attr("title")&&(this.options.title=this.$elem.attr("title"),this.$elem.removeAttr("title")),this.content=null,this.target=this.options.target||this.$elem,this.isOpen=null,this.enabled=!0,this.tolerance=null,this.onlyOne=this.options.onlyOne||!1,this.init()};p.prototype={constructor:p,init:function(){var n=this.options,i=this;n.tpl=this.parseTpl(n.tpl),this.$container=t(n.tpl.container),this.$loading=t(n.tpl.loading),this.$arrow=t(n.tpl.arrow),this.$close=t(n.tpl.close),this.$content=t(n.tpl.content),"hover"===n.trigger&&(this.target.on("mouseenter.tooltip",function(){return i.isOpen===!0?(clearTimeout(this.tolerance),void 0):(t.proxy(i.show,i)(),void 0)}),n.interactive===!0?this.target.on("mouseleave.tooltip",function(){var e=!1;i.$container.on("mouseenter",function(){e=!0}),i.$container.on("mouseleave",function(){e=!1}),clearTimeout(this.tolerance),this.tolerance=setTimeout(function(){e===!0?i.$container.on("mouseleave.tooltip",t.proxy(i.hide,i)):t.proxy(i.hide,i)()},i.options.interactiveDelay)}):this.target.on("mouseleave.tooltip",t.proxy(i.hide,i)),this.options.mouseTrace===!0&&this.target.on("mousemove.tooltip",function(t){var n,s={},o=t.pageX,a=t.pageY;s={top:a,left:o},n=e(s,i.options.position,i.width,i.height,i.options.popSpace,!0),i.$container.css({display:"block",top:n.top,left:n.left})})),"click"===n.trigger&&this.target.on("click.tooltip",function(){i.isOpen===!0?t.proxy(i.hide,i)():t.proxy(i.show,i)()}),r.push(this)},load:function(){var e=this,n=this.options;n.ajax===!0?t.ajax(t.extend({},n.ajaxSettings,{url:n.title,error:function(){throw Error("ajax error")},success:function(t,n){"success"===n&&(e.content=t,e.$container.css({display:"none"}),e.$content.empty().append(e.content),e.$container.removeClass(e.posCss),e.setPosition())}})):this.content=n.inline===!0?-1!==n.title.indexOf("+")?this.$elem.next().css({display:"block"}):t(n.title).css({display:"block"}):n.title},parseTpl:function(e){var n={},i=this;return t.each(e,function(t,e){n[t]=e.replace("{{namespace}}",i.namespace)}),n},showLoading:function(){this.$content.empty(),this.$loading.css({display:"block"})},hideLoading:function(){this.$loading.css({display:"none"})},setPosition:function(){var i,s=this.options,o=this.namespace+"-"+s.position;if(this.width=this.$container.outerWidth(),this.height=this.$container.outerHeight(),s.mouseTrace!==!0){if(s.autoPosition===!0){var a,r=[];if(r=s.ajax===!0&&null===this.content?n(t(this.target)):n(t(this.target),this.$container),0===r.length)a=s.position;else if(1===r.length){var h=c[s.position][r[0]];a=void 0===h?s.position:h}else{var p=l;t.each(r,function(t,e){p.replace(e,"")}),a=p}o=this.namespace+"-"+a,i=e(this.target,a,this.width,this.height,this.options.popSpace)}else i=e(this.target,s.position,this.width,this.height,this.options.popSpace);this.$container.css({display:"block",top:i.top,left:i.left})}else this.$container.addClass("pointer-events-none");this.posCss=o,this.$container.addClass(o)},show:function(){var e=this.options,n=(this.namespace+"-"+e.position,this);if(this.enabled!==!1)return this.onlyOne===!0&&t.each(r,function(t,e){e!==n&&e.isOpen===!0&&e.hide()}),e.closeBtn===!0&&this.$container.append(this.$close),this.$container.append(this.$arrow).append(this.$content),this.$elem.addClass(this.namespace+"_active"),null===this.content&&this.load(),null===this.content?this.$content.append(this.$loading):this.$content.empty().append(this.content),null!==e.skin&&this.$container.addClass(this.namespace+"_"+e.skin),this.$container.css({display:"none",top:0,left:0,position:"absolute",zIndex:99990}).appendTo(t("body")),this.setPosition(),"function"===e.onShow&&e.onShow(this.$elem),this.$container.trigger("show"),this.isOpen=!0,this},hide:function(){this.$container.off(".tooltip"),this.$container.trigger("hide"),this.$elem.removeClass(this.namespace+"_active"),this.$container.remove(),this.$container.removeClass(this.posCss),"function"===this.options.onHide&&this.options.onHide(this.$elem),this.isOpen=!1,a=!1},setContent:function(t){this.content=t},enable:function(){return this.enabled=!0,this.container.addClass(this.namespace+"-enabled"),this},disable:function(){return this.enabled=!1,this.container.removeClass(this.namespace+"-enabled"),this},destroy:function(){this.target.off(".tooltip")}},p.defaults={namespace:"tooltip",skin:null,target:null,trigger:"hover",interactive:!1,interactiveDelay:500,mouseTrace:!1,closeBtn:!1,popSpace:10,position:"n",autoPosition:!0,delay:0,effect:"fade",duration:200,inline:!1,content:null,ajax:!1,ajaxSettings:{dataType:"html",headers:{tooltip:!0}},onShow:null,onHide:null,onUpdate:null,tpl:{container:'<div class="{{namespace}}-container"></div>',loading:'<span class="{{namespace}}-loading"></span>',content:'<div class="{{namespace}}-content"></div>',arrow:'<span class="{{namespace}}-arrow"></span>',close:'<a class="{{namespace}}-close"></a>'}},t.fn.tooltip=function(e){if("string"==typeof e){var n=e,i=arguments.length>1?Array.prototype.slice.call(arguments,1):void 0;return this.each(function(){var e=t.data(this,"tooltip");"function"==typeof e[n]&&e[n].apply(e,i)})}return this.each(function(){t.data(this,"tooltip")||t.data(this,"tooltip",new p(this,e))})}})(jQuery);